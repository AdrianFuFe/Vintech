import { useContext } from "react";
import { TokenContext } from "./TokenContextProvider";
import { Link } from "react-router-dom";
import { useLocation } from "react-router";
import decodeToken from "../utils/decodeToken";

const MessagesButton = (props) => {
  const [token] = useContext(TokenContext);
  const decodedToken = decodeToken(token);

  let id;
  decodedToken ? (id = decodedToken.id) : (id = null);

  let route;
  token ? (route = `/user/${id}/messages`) : (route = "/login");

  const location = useLocation();
  let fill;
  if (location.pathname.includes("messages")) {
    fill = "#d07017";
  } else {
    fill = "#828282";
  }

  return (
    <Link to={route}>
      <svg
        width="157"
        height="113"
        viewBox="0 0 157 113"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M78.5 91.656C70.7944 91.6545 63.1346 90.472 55.7873 88.1497C55.0822 87.9518 54.4264 87.6082 53.8624 87.1409C53.2984 86.6737 52.8388 86.0933 52.5132 85.4372C52.1877 84.7812 52.0035 84.0641 51.9725 83.3324C51.9415 82.6007 52.0644 81.8706 52.3333 81.1893C52.8365 79.9384 53.8031 78.93 55.0316 78.3743C56.26 77.8185 57.6556 77.7584 58.9273 78.2063C71.6152 82.2095 85.2278 82.2095 97.9157 78.2063C99.1874 77.7584 100.583 77.8185 101.811 78.3743C103.04 78.93 104.006 79.9384 104.51 81.1893C104.78 81.8637 104.907 82.587 104.883 83.3133C104.859 84.0395 104.684 84.7527 104.368 85.4074C104.053 86.0622 103.605 86.6442 103.053 87.1163C102.501 87.5884 101.856 87.9404 101.16 88.1497C93.8298 90.4667 86.188 91.6491 78.5 91.656V91.656Z"
          fill={fill}
        />
        <path
          d="M138.683 112.38H18.3167C13.4588 112.38 8.79987 110.45 5.36483 107.015C1.92979 103.58 0 98.9211 0 94.0632V18.8079C0 13.95 1.92979 9.29108 5.36483 5.85604C8.79987 2.421 13.4588 0.491211 18.3167 0.491211H138.683C143.541 0.491211 148.2 2.421 151.635 5.85604C155.07 9.29108 157 13.95 157 18.8079V94.0632C157 98.9211 155.07 103.58 151.635 107.015C148.2 110.45 143.541 112.38 138.683 112.38V112.38ZM18.3167 10.9579C16.2347 10.9579 14.238 11.7849 12.7659 13.2571C11.2937 14.7293 10.4667 16.7259 10.4667 18.8079V94.0632C10.4667 96.1452 11.2937 98.1418 12.7659 99.614C14.238 101.086 16.2347 101.913 18.3167 101.913H138.683C140.765 101.913 142.762 101.086 144.234 99.614C145.706 98.1418 146.533 96.1452 146.533 94.0632V18.8079C146.533 16.7259 145.706 14.7293 144.234 13.2571C142.762 11.7849 140.765 10.9579 138.683 10.9579H18.3167Z"
          fill={fill}
        />
        <path
          d="M78.5002 50.0509C74.4075 50.0555 70.3847 48.9912 66.8298 46.9632L7.95483 15.5632L12.8742 6.35254L71.9062 37.7525C73.8826 38.8815 76.1194 39.4753 78.3955 39.4753C80.6716 39.4753 82.9084 38.8815 84.8848 37.7525L144.021 6.35254L148.941 15.5632L89.9088 46.9632C86.4384 48.9652 82.5066 50.0294 78.5002 50.0509Z"
          fill={fill}
        />
      </svg>
    </Link>
  );
};

export default MessagesButton;
